Filename: Typist(DE_FA).py
توضیح کلی:
این برنامه ترکیبی از تشخیص گفتار و کنترل صفحه‌کلید را پیاده‌سازی می‌کند. با استفاده از تشخیص صدای Google و یک میکروفون، صدای کاربر به متن تبدیل شده و سپس به صورت شبیه‌سازی‌شده در هر مکانی که فوکوس صفحه‌کلید باشد تایپ می‌شود. همچنین با استفاده از کلیدهای صفحه‌کلید (ESC, Ctrl_R, Alt_R) می‌توان برنامه را کنترل کرد.

کتابخانه‌های مورد استفاده:
speech_recognition: برای دریافت و تشخیص صدای کاربر.
pynput: برای گوش دادن به فشردن کلیدهای صفحه‌کلید و کنترل صفحه‌کلید.
threading: برای مدیریت همزمانی (concurrency) و کنترل اشتراک‌گذاری منابع بین نخ‌ها.
time: برای تأخیرهای زمانی کوچک به منظور کاهش استفاده از CPU.
متغیرها:
exit_program: پرچمی برای توقف کامل برنامه. اگر کلید ESC فشرده شود، مقدار آن True می‌شود.
stop_program: برای کنترل حلقه داخلی برنامه. زمانی که کاربر Ctrl_R را فشار می‌دهد، این پرچم تنظیم می‌شود.
language_number: متغیری که برای تغییر زبان تشخیص گفتار بین فارسی (fa-IR) و آلمانی (de-DE) استفاده می‌شود.
lock: قفل برای جلوگیری از شرایط رقابتی هنگام دسترسی به متغیرهای مشترک بین نخ‌ها.
توابع:
۱. on_press(key)
این تابع توسط شنونده صفحه‌کلید (pynput.Listener) فراخوانی می‌شود و بسته به کلید فشرده‌شده اقدامات خاصی انجام می‌دهد:

اگر ESC فشرده شود، برنامه را خاتمه می‌دهد.
اگر Ctrl_R فشرده شود، حلقه داخلی متوقف می‌شود.
اگر Alt_R فشرده شود، زبان تشخیص گفتار بین فارسی و آلمانی جابه‌جا می‌شود.
۲. listen_and_type()
این تابع برای دریافت صدای کاربر و تبدیل آن به متن استفاده می‌شود. پس از تبدیل، متن به‌صورت شبیه‌سازی‌شده با استفاده از pynput.keyboard.Controller تایپ می‌شود. این فرآیند در یک حلقه تکرار می‌شود تا زمانی که کاربر کلید ESC را فشار دهد.

نحوه کنترل برنامه:
ESC: خروج کامل از برنامه.
Ctrl_R: متوقف کردن حلقه داخلی برنامه و گوش دادن مجدد به صدای کاربر.
Alt_R: تغییر زبان تشخیص گفتار بین فارسی و آلمانی.
استثنائات:
sr.UnknownValueError: اگر برنامه قادر به تشخیص گفتار نباشد، پیام خطای "لطفاً دوباره تکرار کنید" نمایش داده می‌شود.
sr.RequestError: اگر اتصال به سرویس Google دچار مشکل شود، پیام خطای مربوطه نمایش داده خواهد شد.
توضیح علت محدودیت‌ها:
حلقه بی‌نهایت و خروج با کلید کنترل:
دلیل وجود حلقه بی‌نهایت این است که وقتی کاربر صحبت نمی‌کند، برنامه نباید دائماً به سرویس گوگل درخواست ارسال کند. این روش بهینه‌سازی مصرف منابع و جلوگیری از ارسال درخواست‌های غیرضروری است. با فشار دادن Ctrl_R، می‌توانید حلقه را متوقف کنید و از ارسال مداوم درخواست جلوگیری نمایید.
تغییر زبان با کلید Alt_R:
دلیل تغییر زبان با Alt_R این است که تشخیص گفتار گوگل برای هر زبان متفاوت است. زبان مناسب باید انتخاب شود تا تشخیص کلمات دقیق‌تر باشد. با تغییر بین فارسی و آلمانی، سرویس گوگل بهتر قادر به شناسایی گفتار شما خواهد بود.
